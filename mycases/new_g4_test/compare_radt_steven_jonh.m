% COMPARE my rad profile and John's

% close all

z = ncread('new_g4_test.default.0000000.nc','z');
zh = ncread('new_g4_test.default.0000000.nc','zh');
rts = ncread('new_g4_test.default.0000000.nc','radt');
fus = ncread('new_g4_test.default.0000000.nc','lupf');
fds = ncread('new_g4_test.default.0000000.nc','ldnf');

rts0 = rts(:,1);
fus0 = fus(:,1);
fds0 = fds(:,1);

% John's values
rtj0 = [4.8274142277209246E-005   3.4814983016685829E-005   2.3450687486968403E-005   1.3428339468587532E-005   4.4956750669757464E-006  -3.4916174433175954E-006  -1.0641157548056309E-005  -1.7041832333663131E-005  -2.2770067333511166E-005  -2.7892755382963022E-005  -3.2468999794292360E-005  -3.6551338883462371E-005  -4.0186688779114139E-005  -4.3417102926059570E-005  -4.6280397910300999E-005  -4.8810675819933112E-005  -5.1038764190565437E-005  -5.2992589317669788E-005  -5.4697495216528681E-005  -5.6176517944045663E-005  -5.7450623033536086E-005  -5.8538912267305034E-005  -5.9458804797144263E-005  -6.0226196678190934E-005  -6.0855602109299979E-005  -6.1360279073833292E-005  -6.1752341594154480E-005  -6.2042860421801339E-005  -6.2241953669526706E-005  -6.2358868658676580E-005  -6.2402056029856647E-005  -6.2379237021172593E-005  -6.2297464670480103E-005  -6.2163179596547928E-005  -6.1982260922527376E-005  -6.1760072825883431E-005  -6.1501507142242080E-005  -6.1211022398413494E-005  -6.0892679601439434E-005  -6.0550175078641365E-005  -6.0186870625938492E-005  -5.9805821203113134E-005  -5.9409800382547131E-005  -5.9001323738194048E-005  -5.8582670355475193E-005  -5.8155902603511255E-005  -5.7722884324783364E-005  -5.7285297563514103E-005  -5.6844657949390784E-005  -5.6402328849551004E-005  -5.5959534385693774E-005  -5.5517371401428875E-005  -5.5076820471657072E-005  -5.4638756022795807E-005  -5.4203955639264319E-005  -5.3773108616350406E-005  -5.3346823821955126E-005  -5.2925636920013406E-005  -5.2510017010400633E-005  -5.2100372720698237E-005  -5.1697057809055065E-005  -5.1300376302008136E-005  -5.0910587213581822E-005  -5.0527908875404536E-005  -5.0152522907944135E-005  -4.9784577866625437E-005  -4.9424192580335230E-005  -4.9071459216561043E-005  -4.8726446088415502E-005  -4.8389200226323437E-005  -4.8059749735297779E-005  -4.7738105954303615E-005  -4.7424265430668397E-005  -4.7118211733563007E-005  -4.6819917106352497E-005  -4.6529343988481120E-005  -4.6246446400332183E-005  -4.5971171218306769E-005  -4.5703459337223923E-005  -4.5443246739358530E-005  -4.5190465472933993E-005  -4.4945044551136235E-005  -4.4706910777122010E-005  -4.4475989505967510E-005  -4.4252205344160793E-005  -4.4035482802533874E-005  -4.3825746897282149E-005  -4.3622923715208378E-005  -4.3426940944841168E-005  -4.3237728378015589E-005  -4.3055218391735008E-005  -4.2879346415706681E-005  -4.2710051389535005E-005  -4.2547276223174492E-005  -4.2390968264626286E-005  -4.2241079785864484E-005  -4.2097568505061075E-005  -4.1960398145511878E-005  -4.1829539068205963E-005  -4.1704968979165392E-005  -4.1586673756666863E-005  -4.1474648415609288E-005  -4.1368898262308151E-005  -4.1269440284264946E-005  -4.1176304842116339E-005  -4.1089537750525647E-005  -4.1009202844236023E-005  -4.0935385169529951E-005  -4.0868194965565491E-005  -4.0807772644326324E-005  -4.0754295047783436E-005  -4.0707983317969945E-005  -4.0669112814385322E-005  -4.0638025646065573E-005  -4.0615146503244015E-005  -4.0601002713613378E-005  -4.0596249678949251E-005  -4.0601703242109375E-005  -4.0618381143209485E-005  -4.0647556874304860E-005  -4.0690831995409171E-005  -4.0750240565917333E-005  -4.0828424335916004E-005  -4.0929018437519192E-005  -4.1057923206825986E-005  -4.1229763524313979E-005  -4.1512253643861040E-005  -4.2391619826557709E-005];
fuj = [189.59393057599996        189.59756634029452        189.60699032575084        189.62099024196124        189.63886623680685        189.66007869964008        189.68417331348786        189.71075634198812        189.73948251390135        189.77004725595700        189.80218091952563        189.83564416911400        189.87022417138851        189.90573139040666        189.94199686390542        189.97886987023367        190.01621591656647        190.05391499363566        190.09186005311059        190.12995567220418        190.16811687672714        190.20626809908765        190.24434225194764        190.28227990161287        190.32002852794744        190.35754185978109        190.39477927654605        190.43170526831292        190.46828894756877        190.50450360703152        190.54032631859553        190.57573756914815        190.61072092954950        190.64526275352139        190.67935190357665        190.71297950145237        190.74613870078429        190.77882448000454        190.81103345365204        190.84276370046581        190.87401460679172        190.90478672397023        190.93508163849998        190.96490185388009        190.99425068313136        191.02313215108893        191.05155090563142        191.07951213709032        191.10702150514396        191.13408507255892        191.16070924519738        191.18690071775748        191.21266642475481        191.23801349629818        191.26294921824706        191.28748099637309        191.31161632417886        191.33536275405626        191.35872787149131        191.38171927205042        191.40434454089802        191.42661123462500        191.44852686517731        191.47009888569696        191.49133467810211        191.51224154224417        191.53282668650004        191.55309721966123        191.57306014400086        191.59272234940468        191.61209060846335        191.63117157243278        191.64997176797630        191.66849759460987        191.68675532278007        191.70475109250594        191.72249091253005        191.73998065991898        191.75722608006780        191.77423278706036        191.79100626434573        191.80755186569303        191.82387481639037        191.83998021465709        191.85587303324121        191.87155812117621        191.88704020567624        191.90232389414530        191.91741367628441        191.93231392627976        191.94702890505476        191.96156276257324        191.97591954018267        191.99010317298419        192.00411749222076        192.01796622767489        192.03165301006703        192.04518137344971        192.05855475758773        192.07177651032367        192.08484988991910        192.09777806737176        192.11056412870175        192.12321107720558        192.13572183567518        192.14809924857781        192.16034608419869        192.17246503674025        192.18445872838072        192.19632971128920        192.20808046959561        192.21971342131758        192.23123092024161        192.24263525775862        192.25392866465597        192.26511331286309        192.27619131715289        192.28716473679927        192.29803557718910        192.30880579139307        192.31947728169158        192.33005190105914        192.34053145460797        192.35091770098930        192.36121235375583        192.37141708268419        192.38153351505954        192.39156323692188        192.40151120221367];
fdj = [100.95795285378988        100.99568289398700        101.02969543929173        101.06025772557376        101.08761766957224        101.11200526465787        101.13363387573807        101.15270144059149        101.16939158439402        101.18387465370796        101.19630867575320        101.20684024835994        101.21560536561080        101.22273018381948        101.22833173215618        101.23251857191985        101.23539140816766        101.23704365714310        101.23756197269759        101.23702673466724        101.23551250195446        101.23308843286325        101.22981867505537        101.22576272732120        101.22097577520225        101.21550900235343        101.20940987939929        101.20272243190814        101.19548748899442        101.18774291394736        101.17952381818498        101.17086275973722        101.16178992737646        101.15233331143185        101.14251886224810        101.13237063718279        101.12191093696811        101.11116043220656        101.10013828071163        101.08886223635494        101.07734875003301        101.06561306332247        101.05366929535076        101.04153052337223        101.02920885750429        101.01671551004330        101.00406085975260        100.99125451148403        100.97830535146946        100.96522159859472        100.95201085194449        100.93868013488664        100.92523593594559        100.91168424669456        100.89803059688171        100.88428008698772        100.87043741839996        100.85650692137381        100.84249258093867        100.82839806089622        100.81422672604727        100.79998166277252        100.78566569808483        100.77128141726091        100.75683118015392        100.74231713627832        100.72774123875473        100.71310525719383        100.69841078959344        100.68365927331683        100.66885199521637        100.65399010096010        100.63907460361519        100.62410639153991        100.60908623562767        100.59401479594788        100.57889262782111        100.56372018736563        100.54849783654751        100.53322584776551        100.51790440799688        100.50253362253089        100.48711351831119        100.47164404690888        100.45612508714285        100.44055644736505        100.42493786742344        100.40926902031408        100.39354951353241        100.37777889012983        100.36195662948057        100.34608214775889        100.33015479812637        100.31417387062302        100.29813859175124        100.28204812373924        100.26590156346171        100.24969794098750        100.23343621771876        100.21711528406830        100.20073395661336        100.18429097464100        100.16778499598148        100.15121459199376        100.13457824153460        100.11787432369347        100.10110110902053        100.08425674889905        100.06733926262292        100.05034652161903        100.03327623010719        100.01612590129783        99.998892827985713        99.981574046093513        99.964166289321184        99.946665932567399        99.929068921141948        99.911370681969103        99.893566011885838        99.875648936620038        99.857612531688005        99.839448692176475        99.821147828727490        99.802698439749776        99.784086411191609        99.765293418031789        99.746290763734947        99.727001886398924        99.707010188049992];
                                                
zjh =  [0.0000000000000000       0.75000000000000000        1.5000000000000000        2.2500000000000000        3.0000000000000000        3.7500000000000000        4.5000000000000000        5.2500000000000000        6.0000000000000000        6.7500000000000000        7.5000000000000000        8.2500000000000000        9.0000000000000000        9.7500000000000000        10.500000000000000        11.250000000000000        12.000000000000000        12.750000000000000        13.500000000000000        14.250000000000000        15.000000000000000        15.750000000000000        16.500000000000000        17.250000000000000        18.000000000000000        18.750000000000000        19.500000000000000        20.250000000000000        21.000000000000000        21.750000000000000        22.500000000000000        23.250000000000000        24.000000000000000        24.750000000000000        25.500000000000000        26.250000000000000        27.000000000000000        27.750000000000000        28.500000000000000        29.250000000000000        30.000000000000000        30.750000000000000        31.500000000000000        32.250000000000000        33.000000000000000        33.750000000000000        34.500000000000000        35.250000000000000        36.000000000000000        36.750000000000000        37.500000000000000        38.250000000000000        39.000000000000000        39.750000000000000        40.500000000000000        41.250000000000000        42.000000000000000        42.750000000000000        43.500000000000000        44.250000000000000        45.000000000000000        45.750000000000000        46.500000000000000        47.250000000000000        48.000000000000000        48.750000000000000        49.500000000000000        50.250000000000000        51.000000000000000        51.750000000000000        52.500000000000000        53.250000000000000        54.000000000000000        54.750000000000000        55.500000000000000        56.250000000000000        57.000000000000000        57.750000000000000        58.500000000000000        59.250000000000000        60.000000000000000        60.750000000000000        61.500000000000000        62.250000000000000        63.000000000000000        63.750000000000000        64.500000000000000        65.250000000000000        66.000000000000000        66.750000000000000        67.500000000000000        68.250000000000000        69.000000000000000        69.750000000000000        70.500000000000000        71.250000000000000        72.000000000000000        72.750000000000000        73.500000000000000        74.250000000000000        75.000000000000000        75.750000000000000        76.500000000000000        77.250000000000000        78.000000000000000        78.750000000000000        79.500000000000000        80.250000000000000        81.000000000000000        81.750000000000000        82.500000000000000        83.250000000000000        84.000000000000000        84.750000000000000        85.500000000000000        86.250000000000000        87.000000000000000        87.750000000000000        88.500000000000000        89.250000000000000        90.000000000000000        90.750000000000000        91.500000000000000        92.250000000000000        93.000000000000000        93.750000000000000        94.500000000000000        95.250000000000000        96.000000000000000];
zj = zjh(2:end) - 0.75/2;

figure(1); plot(rts0,z,'-oblack'); hold on; plot(rtj0,zj,'-or');
figure(2); plot(fus0,zh,'-oblack'); hold on; plot(fuj,zjh,'-or');
figure(3); plot(fds0,zh,'-oblack'); hold on; plot(fdj,zjh,'-or');
 
figure(5); plot((fuj'-fus0)./fus0,zh,'-oblack')
figure(6); plot((fdj'-fds0)./fds0,zh,'-oblack')
figure(7); plot((rtj0'-rts0)./rts0,z,'-oblack')